<!DOCTYPE html>
<html>
<head>
    <title>Image Upload</title>
</head>
<style>
  form {
    width: 600px;
    height: auto;
    display: grid;
    place-items: center;
  }
  .image {
    margin-top: 50px;
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 50%;
  }
</style>
<body>
  <form>
    <label for="imageUpload">Upload an image:</label>
    <input type="file" id="imageUpload" name="image" accept="image/png, image/jpeg">
    <button class="upload" type="button">Upload</button>
    <!-- <input type="submit" value="Upload"> -->
  </form>
</body>
<script type="module">
  import axios from 'https://cdn.jsdelivr.net/npm/axios@1.3.5/+esm';

  const url = 'https://api.cloudinary.com/v1_1/dkd5jyxby/image/upload';
  
  
  const postUrl = async (endpoint, file) => {
    const body = {
      file,
      api_key: 357824561481388,
      upload_preset: 't4dskobq'
    }
    const headers = {
      "Content-Type": "multipart/form-data",
    }
    const response = await axios.post(endpoint, body, { headers });
    return response.data.url
  }

  const form = document.querySelector('form');
  const submitButton = document.querySelector('.upload');

  submitButton.addEventListener('click', async () => {
    const fileInput = document.querySelector('#imageUpload');
    const file =  fileInput.files[0];
    const img = document.createElement('img');
    img.classList = 'image';
    img.src = await postUrl(url, file);
    console.log(img);
    form.appendChild(img);
    
  })
</script>
</html>